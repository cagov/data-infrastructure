{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-11-19T17:27:21.966070Z", "invocation_id": "9c6b66f0-e6d6-42bd-b317-d3032d5a951a", "invocation_started_at": "2025-11-19T17:27:13.160547Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:20.982245Z", "completed_at": "2025-11-19T17:27:21.006517Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.008514Z", "completed_at": "2025-11-19T17:27:21.008533Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030384540557861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_cortex_usage_daily_history", "compiled": true, "compiled_code": "\n\n-- The ORGANIZATION_USAGE schema does not provide a specific\n-- view on Cortex usage, so we need to get it from the overall\n-- metering daily history table.\n-- https://docs.snowflake.com/en/user-guide/snowflake-cortex/aisql#track-costs-for-ai-services\nWITH source AS (\n    SELECT\n        credits_adjustment_cloud_services,\n        region,\n        credits_used,\n        service_type,\n        account_locator,\n        usage_date,\n        account_name,\n        credits_billed,\n        credits_used_cloud_services,\n        organization_name,\n        credits_used_compute\n    FROM snowflake.organization_usage.metering_daily_history\n    WHERE service_type = 'AI_SERVICES'\n),\n\nmetering_daily_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used_compute) AS credits_used_compute,\n        sum(credits_used_cloud_services) AS credits_used_cloud_services,\n        sum(credits_adjustment_cloud_services) AS credits_adjustment_cloud_services,\n        sum(credits_used) AS credits_used,\n        sum(credits_billed) AS credits_billed\n    FROM source\n    GROUP BY organization_name, account_name, usage_date\n)\n\nSELECT *\nFROM metering_daily_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:20.994174Z", "completed_at": "2025-11-19T17:27:21.007034Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.009322Z", "completed_at": "2025-11-19T17:27:21.009331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030139684677124023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.geo_reference__global_ml_building_footprints_with_tiger", "compiled": true, "compiled_code": "with footprints as ( -- noqa: ST03\n    select\n        \"height\",\n        \"geometry\"\n    from RAW_DEV.building_footprints.global_ml_building_footprints\n),\n\nblocks_source as (\n    select *\n    from RAW_DEV.tiger_2022.blocks\n),\n\nplaces_source as (\n    select * from RAW_DEV.tiger_2022.places\n),\n\nblocks as ( -- noqa: ST03\n    select\n        countyfp20 as \"county_fips\",\n        tractce20 as \"tract\",\n        blockce20 as \"block\",\n        geoid20 as \"block_geoid\",\n        \"geometry\"\n    from blocks_source\n),\n\nplaces as ( -- noqa: ST03\n    select\n        placefp as \"place_fips\",\n        placens as \"place_ns\",\n        geoid as \"place_geoid\",\n        name as \"place_name\",\n        classfp as \"class_fips_code\",\n        \n\ncase\n    when \"CLASSFP\" = 'M2'\n    then 'A military or other defense installation entirely within a place'\n    when \"CLASSFP\" = 'C1'\n    then 'An active incorporated place that does not serve as a county subdivision equivalent'\n    when \"CLASSFP\" = 'U1'\n    then 'A census designated place with an official federally recognized name'\n    when \"CLASSFP\" = 'U2'\n    then 'A census designated place without an official federally recognized name'\n    end as \"class_fips\",\n        \"geometry\"\n    from places_source\n),\n\nfootprints_with_blocks as ( -- noqa: ST03\n    \n\nwith b_left_model_with_id as (\n    select\n        /* Generate a temporary ID for footprints. We will need this to group/partition\n        by unique footprints further down. We could use a UUID, but integers are\n        cheaper to generate and compare. */\n        *, seq4() as _tmp_sjoin_id\n    from footprints\n),\n\nb_joined as (\n    select\n      b_left_model_with_id.\"height\",\n      blocks.\"county_fips\",\n      blocks.\"tract\",\n      blocks.\"block\",\n      blocks.\"block_geoid\",\n      b_left_model_with_id.\"geometry\",\n      /* We don't actually need the intersection for every geometry, only for the\n       ones that intersect more than one. However, in order to establish which\n       ones intersect more than one, we need a windowed COUNT partitioned by\n       _tmp_sjoin_id. This is an expensive operation, as it likely triggers a shuffle\n       (even though it should already be sorted by _tmp_id). In testing we've found\n       that it's cheaper to just do the intersection for all the geometries. */\n      st_area(\n        st_intersection(b_left_model_with_id.\"geometry\", blocks.\"geometry\")\n      ) as _tmp_sjoin_intersection,\n      b_left_model_with_id._tmp_sjoin_id\n    from b_left_model_with_id\n    inner join blocks\n    on st_intersects(b_left_model_with_id.\"geometry\", blocks.\"geometry\")\n),\n\nb_deduplicated as (\n    select\n      -- Snowflake doesn't support geometries in max_by. It should, but it doesn't.\n      -- Fortunately, we know that the geometries are identical when partitioned\n      -- by _tmp_sjoin_id, so we can just choose any_value.\n      any_value(\"geometry\") as \"geometry\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"height\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"height\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"county_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"county_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"tract\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"tract\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block_geoid\"\n      from b_joined\n    group by _tmp_sjoin_id\n)\n\nselect * from b_deduplicated\n),\n\nfootprints_with_blocks_and_places as (\n    \n\nwith p_left_model_with_id as (\n    select\n        /* Generate a temporary ID for footprints. We will need this to group/partition\n        by unique footprints further down. We could use a UUID, but integers are\n        cheaper to generate and compare. */\n        *, seq4() as _tmp_sjoin_id\n    from footprints_with_blocks\n),\n\np_joined as (\n    select\n      p_left_model_with_id.\"height\",\n      p_left_model_with_id.\"county_fips\",\n      p_left_model_with_id.\"tract\",\n      p_left_model_with_id.\"block\",\n      p_left_model_with_id.\"block_geoid\",\n      places.\"place_fips\",\n      places.\"place_ns\",\n      places.\"place_geoid\",\n      places.\"place_name\",\n      places.\"class_fips_code\",\n      places.\"class_fips\",\n      p_left_model_with_id.\"geometry\",\n      /* We don't actually need the intersection for every geometry, only for the\n       ones that intersect more than one. However, in order to establish which\n       ones intersect more than one, we need a windowed COUNT partitioned by\n       _tmp_sjoin_id. This is an expensive operation, as it likely triggers a shuffle\n       (even though it should already be sorted by _tmp_id). In testing we've found\n       that it's cheaper to just do the intersection for all the geometries. */\n      st_area(\n        st_intersection(p_left_model_with_id.\"geometry\", places.\"geometry\")\n      ) as _tmp_sjoin_intersection,\n      p_left_model_with_id._tmp_sjoin_id\n    from p_left_model_with_id\n    left join places\n    on st_intersects(p_left_model_with_id.\"geometry\", places.\"geometry\")\n),\n\np_deduplicated as (\n    select\n      -- Snowflake doesn't support geometries in max_by. It should, but it doesn't.\n      -- Fortunately, we know that the geometries are identical when partitioned\n      -- by _tmp_sjoin_id, so we can just choose any_value.\n      any_value(\"geometry\") as \"geometry\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"height\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"height\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"county_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"county_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"tract\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"tract\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block_geoid\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_ns\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_ns\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_geoid\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_name\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_name\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"class_fips_code\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"class_fips_code\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"class_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"class_fips\"\n      from p_joined\n    group by _tmp_sjoin_id\n)\n\nselect * from p_deduplicated\n),\n\nfootprints_with_blocks_and_places_final as (\n    select\n        *,\n        st_area(\"geometry\") as \"area_sqm\"\n    from footprints_with_blocks_and_places\n)\n\nselect * from footprints_with_blocks_and_places_final", "relation_name": "ANALYTICS_DEV.ci_should_not_create_this_schema_building_footprints.geo_reference__global_ml_building_footprints_with_tiger", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:20.999323Z", "completed_at": "2025-11-19T17:27:21.007550Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.010084Z", "completed_at": "2025-11-19T17:27:21.010094Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03035759925842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.geo_reference__us_building_footprints_with_tiger", "compiled": true, "compiled_code": "with footprints as ( -- noqa: ST03\n    select\n        \"release\",\n        \"capture_dates_range\",\n        \"geometry\"\n    from RAW_DEV.building_footprints.us_building_footprints\n),\n\nblocks_source as (\n    select *\n    from RAW_DEV.tiger_2022.blocks\n),\n\nplaces_source as (\n    select * from RAW_DEV.tiger_2022.places\n),\n\nblocks as ( -- noqa: ST03\n    select\n        countyfp20 as \"county_fips\",\n        tractce20 as \"tract\",\n        blockce20 as \"block\",\n        geoid20 as \"block_geoid\",\n        \"geometry\"\n    from blocks_source\n),\n\nplaces as ( -- noqa: ST03\n    select\n        placefp as \"place_fips\",\n        placens as \"place_ns\",\n        geoid as \"place_geoid\",\n        name as \"place_name\",\n        classfp as \"class_fips_code\",\n        \n\ncase\n    when \"CLASSFP\" = 'M2'\n    then 'A military or other defense installation entirely within a place'\n    when \"CLASSFP\" = 'C1'\n    then 'An active incorporated place that does not serve as a county subdivision equivalent'\n    when \"CLASSFP\" = 'U1'\n    then 'A census designated place with an official federally recognized name'\n    when \"CLASSFP\" = 'U2'\n    then 'A census designated place without an official federally recognized name'\n    end as \"class_fips\",\n        \"geometry\"\n    from places_source\n),\n\nfootprints_with_blocks as ( -- noqa: ST03\n    \n\nwith b_left_model_with_id as (\n    select\n        /* Generate a temporary ID for footprints. We will need this to group/partition\n        by unique footprints further down. We could use a UUID, but integers are\n        cheaper to generate and compare. */\n        *, seq4() as _tmp_sjoin_id\n    from footprints\n),\n\nb_joined as (\n    select\n      b_left_model_with_id.\"release\",\n      b_left_model_with_id.\"capture_dates_range\",\n      blocks.\"county_fips\",\n      blocks.\"tract\",\n      blocks.\"block\",\n      blocks.\"block_geoid\",\n      b_left_model_with_id.\"geometry\",\n      /* We don't actually need the intersection for every geometry, only for the\n       ones that intersect more than one. However, in order to establish which\n       ones intersect more than one, we need a windowed COUNT partitioned by\n       _tmp_sjoin_id. This is an expensive operation, as it likely triggers a shuffle\n       (even though it should already be sorted by _tmp_id). In testing we've found\n       that it's cheaper to just do the intersection for all the geometries. */\n      st_area(\n        st_intersection(b_left_model_with_id.\"geometry\", blocks.\"geometry\")\n      ) as _tmp_sjoin_intersection,\n      b_left_model_with_id._tmp_sjoin_id\n    from b_left_model_with_id\n    inner join blocks\n    on st_intersects(b_left_model_with_id.\"geometry\", blocks.\"geometry\")\n),\n\nb_deduplicated as (\n    select\n      -- Snowflake doesn't support geometries in max_by. It should, but it doesn't.\n      -- Fortunately, we know that the geometries are identical when partitioned\n      -- by _tmp_sjoin_id, so we can just choose any_value.\n      any_value(\"geometry\") as \"geometry\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"release\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"release\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"capture_dates_range\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"capture_dates_range\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"county_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"county_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"tract\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"tract\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block_geoid\"\n      from b_joined\n    group by _tmp_sjoin_id\n)\n\nselect * from b_deduplicated\n),\n\nfootprints_with_blocks_and_places as (\n    \n\nwith p_left_model_with_id as (\n    select\n        /* Generate a temporary ID for footprints. We will need this to group/partition\n        by unique footprints further down. We could use a UUID, but integers are\n        cheaper to generate and compare. */\n        *, seq4() as _tmp_sjoin_id\n    from footprints_with_blocks\n),\n\np_joined as (\n    select\n      p_left_model_with_id.\"release\",\n      p_left_model_with_id.\"capture_dates_range\",\n      p_left_model_with_id.\"county_fips\",\n      p_left_model_with_id.\"tract\",\n      p_left_model_with_id.\"block\",\n      p_left_model_with_id.\"block_geoid\",\n      places.\"place_fips\",\n      places.\"place_ns\",\n      places.\"place_geoid\",\n      places.\"place_name\",\n      places.\"class_fips_code\",\n      places.\"class_fips\",\n      p_left_model_with_id.\"geometry\",\n      /* We don't actually need the intersection for every geometry, only for the\n       ones that intersect more than one. However, in order to establish which\n       ones intersect more than one, we need a windowed COUNT partitioned by\n       _tmp_sjoin_id. This is an expensive operation, as it likely triggers a shuffle\n       (even though it should already be sorted by _tmp_id). In testing we've found\n       that it's cheaper to just do the intersection for all the geometries. */\n      st_area(\n        st_intersection(p_left_model_with_id.\"geometry\", places.\"geometry\")\n      ) as _tmp_sjoin_intersection,\n      p_left_model_with_id._tmp_sjoin_id\n    from p_left_model_with_id\n    left join places\n    on st_intersects(p_left_model_with_id.\"geometry\", places.\"geometry\")\n),\n\np_deduplicated as (\n    select\n      -- Snowflake doesn't support geometries in max_by. It should, but it doesn't.\n      -- Fortunately, we know that the geometries are identical when partitioned\n      -- by _tmp_sjoin_id, so we can just choose any_value.\n      any_value(\"geometry\") as \"geometry\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"release\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"release\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"capture_dates_range\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"capture_dates_range\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"county_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"county_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"tract\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"tract\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"block_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"block_geoid\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_fips\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_ns\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_ns\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_geoid\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_geoid\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"place_name\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"place_name\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"class_fips_code\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"class_fips_code\",\n      -- max_by returns null if all the values in a group are null. So if we have a left\n      -- join, we need to guard against nulls with a coalesce to return the single value\n      max_by(\"class_fips\", coalesce(_tmp_sjoin_intersection, 1.0)) as \"class_fips\"\n      from p_joined\n    group by _tmp_sjoin_id\n)\n\nselect * from p_deduplicated\n),\n\nfootprints_with_blocks_and_places_final as (\n    select\n        *,\n        st_area(\"geometry\") as \"area_sqm\"\n    from footprints_with_blocks_and_places\n)\n\nselect * from footprints_with_blocks_and_places_final", "relation_name": "ANALYTICS_DEV.ci_should_not_create_this_schema_building_footprints.geo_reference__us_building_footprints_with_tiger", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:20.987369Z", "completed_at": "2025-11-19T17:27:21.008030Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.010865Z", "completed_at": "2025-11-19T17:27:21.010872Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03213858604431152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_automatic_clustering_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        num_rows_reclustered,\n        account_locator,\n        database_id,\n        schema_name,\n        database_name,\n        table_id,\n        schema_id,\n        account_name,\n        region,\n        credits_used,\n        organization_name,\n        table_name,\n        usage_date,\n        num_bytes_reclustered\n    FROM snowflake.organization_usage.automatic_clustering_history\n),\n\nautomatic_clustering_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        database_name,\n        schema_name,\n        table_name,\n        usage_date,\n        sum(credits_used) AS credits_used,\n        sum(num_rows_reclustered) AS num_rows_reclustered,\n        sum(num_bytes_reclustered) AS num_bytes_reclustered\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM automatic_clustering_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_automatic_clustering_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.021689Z", "completed_at": "2025-11-19T17:27:21.032792Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.033479Z", "completed_at": "2025-11-19T17:27:21.033489Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018788576126098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_database_storage_usage_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        region,\n        average_hybrid_table_storage_bytes,\n        organization_name,\n        usage_date,\n        database_id,\n        database_name,\n        account_name,\n        average_database_bytes,\n        account_locator,\n        average_failsafe_bytes\n    FROM snowflake.organization_usage.database_storage_usage_history\n),\n\ndatabase_storage_usage_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        database_name,\n        usage_date,\n        AVG(average_hybrid_table_storage_bytes) AS average_hybrid_table_storage_bytes,\n        AVG(average_database_bytes) AS average_database_bytes,\n        AVG(average_failsafe_bytes) AS average_failsafe_bytes\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM database_storage_usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_database_storage_usage_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.018194Z", "completed_at": "2025-11-19T17:27:21.038929Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.041204Z", "completed_at": "2025-11-19T17:27:21.041215Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027127504348754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_data_transfer_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        organization_name,\n        account_name,\n        account_locator,\n        region,\n        usage_date,\n        source_cloud,\n        source_region,\n        target_cloud,\n        target_region,\n        bytes_transferred,\n        transfer_type\n    FROM snowflake.organization_usage.data_transfer_history\n),\n\ndata_transfer_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        usage_date,\n        source_cloud,\n        source_region,\n        target_cloud,\n        target_region,\n        sum(bytes_transferred) AS bytes_transferred\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM data_transfer_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_data_transfer_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.025156Z", "completed_at": "2025-11-19T17:27:21.039681Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.041992Z", "completed_at": "2025-11-19T17:27:21.041999Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.026788949966430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_department_of_finance__entities", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith\nbase_entities as (select * from RAW_DEV.state_entities.base_entities),\n\ninvalid_subagencies as (\n    select *\n    from base_entities\n    where contains(\"name\", 'no subagency') and contains(\"name\", 'do not use')\n),\n\nentities as (\n    select\n        -- Extract the first portion of the entity as the name. The other\n        -- two (optional) groups match parentheticals and things like\n        -- \"-- DO NOT USE\" or \" -- DOF USE ONLY\"\n        PUBLIC.extract_name(\"name\") as name,\n        coalesce(l3, l2, l1, b, a) as primary_code,\n        a as agency_code,\n        case\n            when b in (select invalid_subagencies.b from invalid_subagencies) then null else b\n        end as subagency_code,\n        l1,\n        l2,\n        l3,\n        regexp_substr(\"name\", '\\\\((.+?)\\\\)') as parenthetical,\n        contains(lower(\"name\"), 'do not use') as do_not_use,\n        contains(lower(\"name\"), 'abolished') as abolished,\n        regexp_substr(\"name\", '[A-Z/]+ USE ONLY') as restricted_use,\n        \"name\" as name_raw\n    from base_entities\n),\n\nentities_with_extras as (\n    select\n        *,\n        PUBLIC.reorder_name_for_alphabetization(name) as name_alpha,\n        case\n            when coalesce(l3, l2, l1, subagency_code) is null\n                then 'agency'\n            when coalesce(l3, l2, l1) is null\n                then 'subagency'\n            when coalesce(l3, l2) is null\n                then 'L1'\n            when l3 is null\n                then 'L2'\n            else 'L3'\n        end as ucm_level\n    from entities\n)\n\nselect *\nfrom entities_with_extras", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_department_of_finance__entities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.029729Z", "completed_at": "2025-11-19T17:27:21.040228Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.042747Z", "completed_at": "2025-11-19T17:27:21.042756Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02703547477722168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_ebudget__budgets", "compiled": true, "compiled_code": "with\nagencies_and_departments as (\n    select *\n    from RAW_DEV.state_entities.ebudget_agency_and_department_budgets\n),\n\nebudget_budgets as (\n    select\n        \"web_agency_cd\" as primary_code,\n        \"legal_titl\" as name,\n        \"all_budget_year_dols\" as budget_year_dollars\n    from agencies_and_departments\n)\n\nselect *\nfrom ebudget_budgets", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_ebudget__budgets", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.035690Z", "completed_at": "2025-11-19T17:27:21.040726Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.043520Z", "completed_at": "2025-11-19T17:27:21.043527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008853435516357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_materialized_view_refresh_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        schema_name,\n        credits_used,\n        organization_name,\n        database_id,\n        schema_id,\n        table_id,\n        account_locator,\n        account_name,\n        region,\n        database_name,\n        table_name,\n        usage_date\n    FROM snowflake.organization_usage.materialized_view_refresh_history\n),\n\nmaterialized_view_refresh_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        database_name,\n        schema_name,\n        table_name,\n        usage_date,\n        sum(credits_used) AS credits_used\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM materialized_view_refresh_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_materialized_view_refresh_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.054022Z", "completed_at": "2025-11-19T17:27:21.063661Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.065463Z", "completed_at": "2025-11-19T17:27:21.065475Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018390655517578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_pipe_usage_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        region,\n        organization_name,\n        bytes_inserted,\n        files_inserted,\n        usage_date,\n        account_locator,\n        credits_used,\n        account_name,\n        pipe_id,\n        pipe_name\n    FROM snowflake.organization_usage.pipe_usage_history\n),\n\npipe_usage_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        pipe_name,\n        usage_date,\n        sum(bytes_inserted) AS bytes_inserted,\n        sum(files_inserted) AS files_inserted,\n        sum(credits_used) AS credits_used\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM pipe_usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_pipe_usage_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.050640Z", "completed_at": "2025-11-19T17:27:21.064260Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.066246Z", "completed_at": "2025-11-19T17:27:21.066253Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019708633422851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_metering_daily_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        credits_adjustment_cloud_services,\n        region,\n        credits_used,\n        service_type,\n        account_locator,\n        usage_date,\n        account_name,\n        credits_billed,\n        credits_used_cloud_services,\n        organization_name,\n        credits_used_compute\n    FROM snowflake.organization_usage.metering_daily_history\n),\n\nmetering_daily_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used_compute) AS credits_used_compute,\n        sum(credits_used_cloud_services) AS credits_used_cloud_services,\n        sum(credits_adjustment_cloud_services) AS credits_adjustment_cloud_services,\n        sum(credits_used) AS credits_used,\n        sum(credits_billed) AS credits_billed\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM metering_daily_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.056909Z", "completed_at": "2025-11-19T17:27:21.064970Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.067016Z", "completed_at": "2025-11-19T17:27:21.067023Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01935577392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_stage_storage_usage_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        organization_name,\n        account_locator,\n        account_name,\n        region,\n        usage_date,\n        average_stage_bytes\n    FROM snowflake.organization_usage.stage_storage_usage_history\n),\n\nstage_storage_usage_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        usage_date,\n        avg(average_stage_bytes) AS average_stage_bytes\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM stage_storage_usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_stage_storage_usage_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.060019Z", "completed_at": "2025-11-19T17:27:21.067846Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.070168Z", "completed_at": "2025-11-19T17:27:21.070174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022020339965820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_storage_daily_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        organization_name,\n        account_name,\n        account_locator,\n        region,\n        usage_date,\n        service_type,\n        average_bytes,\n        credits\n    FROM snowflake.organization_usage.storage_daily_history\n),\n\nstorage_daily_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        usage_date,\n        avg(average_bytes) AS average_bytes,\n        sum(credits) AS credits_used\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM storage_daily_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_storage_daily_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.075118Z", "completed_at": "2025-11-19T17:27:21.091694Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.096388Z", "completed_at": "2025-11-19T17:27:21.096401Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02552056312561035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.stg_warehouse_metering_history", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT\n        account_name,\n        warehouse_id,\n        credits_used,\n        credits_used_compute,\n        region,\n        start_time,\n        credits_used_cloud_services,\n        warehouse_name,\n        organization_name,\n        service_type,\n        account_locator,\n        end_time\n    FROM snowflake.organization_usage.warehouse_metering_history\n),\n\nwarehouse_metering_history AS (\n    SELECT\n        organization_name,\n        account_name,\n        warehouse_name,\n        to_date(start_time) AS usage_date,\n        sum(credits_used) AS credits_used,\n        sum(credits_used_compute) AS credits_used_compute,\n        sum(credits_used_cloud_services) AS credits_used_cloud_services\n    FROM source\n    GROUP BY ALL\n)\n\nSELECT *\nFROM warehouse_metering_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_warehouse_metering_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.078044Z", "completed_at": "2025-11-19T17:27:21.097327Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.098583Z", "completed_at": "2025-11-19T17:27:21.098590Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027137279510498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.dbt_utils_source_unique_combination_of_columns_state_entities_base_entities_A__B__L1__L2__L3.3301323f63", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        A, B, L1, L2, L3\n    from RAW_DEV.state_entities.base_entities\n    group by A, B, L1, L2, L3\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.082264Z", "completed_at": "2025-11-19T17:27:21.099952Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.102180Z", "completed_at": "2025-11-19T17:27:21.102190Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03026580810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_not_null_state_entities_base_entities__A_.3b0e8bceb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"A\"\nfrom RAW_DEV.state_entities.base_entities\nwhere \"A\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.092234Z", "completed_at": "2025-11-19T17:27:21.101046Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.103503Z", "completed_at": "2025-11-19T17:27:21.103510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02893972396850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_not_null_state_entities_base_entities__name_.175bb24173", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"name\"\nfrom RAW_DEV.state_entities.base_entities\nwhere \"name\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.104207Z", "completed_at": "2025-11-19T17:27:21.110247Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.115882Z", "completed_at": "2025-11-19T17:27:21.115890Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016570329666137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_not_null_state_entities_ebudget_agency_and_department_budgets__org_cd_.6650ae0ce8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"org_cd\"\nfrom RAW_DEV.state_entities.ebudget_agency_and_department_budgets\nwhere \"org_cd\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.110758Z", "completed_at": "2025-11-19T17:27:21.120923Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.131613Z", "completed_at": "2025-11-19T17:27:21.131623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028738021850585938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_not_null_state_entities_ebudget_agency_and_department_budgets__web_agency_cd_.1100593dca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"web_agency_cd\"\nfrom RAW_DEV.state_entities.ebudget_agency_and_department_budgets\nwhere \"web_agency_cd\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.117252Z", "completed_at": "2025-11-19T17:27:21.132979Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.134718Z", "completed_at": "2025-11-19T17:27:21.134725Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02505016326904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_not_null_state_entities_ebudget_program_budgets__program_code_.29940cbe43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"program_code\"\nfrom RAW_DEV.state_entities.ebudget_program_budgets\nwhere \"program_code\" is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.122132Z", "completed_at": "2025-11-19T17:27:21.135448Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.140879Z", "completed_at": "2025-11-19T17:27:21.140891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02614140510559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_unique_state_entities_base_entities__L3_.28ccbe9ad4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    \"L3\" as unique_field,\n    count(*) as n_records\n\nfrom RAW_DEV.state_entities.base_entities\nwhere \"L3\" is not null\ngroup by \"L3\"\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.136454Z", "completed_at": "2025-11-19T17:27:21.147204Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.149083Z", "completed_at": "2025-11-19T17:27:21.149094Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016700267791748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_unique_state_entities_ebudget_agency_and_department_budgets__org_cd_.f2687093d8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    \"org_cd\" as unique_field,\n    count(*) as n_records\n\nfrom RAW_DEV.state_entities.ebudget_agency_and_department_budgets\nwhere \"org_cd\" is not null\ngroup by \"org_cd\"\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.143503Z", "completed_at": "2025-11-19T17:27:21.153354Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.158311Z", "completed_at": "2025-11-19T17:27:21.158319Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022457361221313477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.source_unique_state_entities_ebudget_agency_and_department_budgets__web_agency_cd_.926c843b75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    \"web_agency_cd\" as unique_field,\n    count(*) as n_records\n\nfrom RAW_DEV.state_entities.ebudget_agency_and_department_budgets\nwhere \"web_agency_cd\" is not null\ngroup by \"web_agency_cd\"\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.149865Z", "completed_at": "2025-11-19T17:27:21.160424Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.162509Z", "completed_at": "2025-11-19T17:27:21.162516Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02024364471435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_cortex_usage_daily_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by organization_name, account_name, usage_date\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_cortex_usage_daily_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.154590Z", "completed_at": "2025-11-19T17:27:21.161998Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.167506Z", "completed_at": "2025-11-19T17:27:21.167518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01914191246032715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_cortex_usage_daily_history_CREDITS_ADJUSTMENT_CLOUD_SERVICES.515dc5d8b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_ADJUSTMENT_CLOUD_SERVICES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\nwhere CREDITS_ADJUSTMENT_CLOUD_SERVICES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.163238Z", "completed_at": "2025-11-19T17:27:21.173627Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.175803Z", "completed_at": "2025-11-19T17:27:21.175810Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016775846481323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_cortex_usage_daily_history_CREDITS_BILLED.0ee925ed8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_BILLED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\nwhere CREDITS_BILLED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.168952Z", "completed_at": "2025-11-19T17:27:21.174838Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.177042Z", "completed_at": "2025-11-19T17:27:21.177049Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015598773956298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_cortex_usage_daily_history_CREDITS_USED.5ebe946f2d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.177813Z", "completed_at": "2025-11-19T17:27:21.187824Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.189784Z", "completed_at": "2025-11-19T17:27:21.189793Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.016855955123901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_cortex_usage_daily_history_CREDITS_USED_CLOUD_SERVICES.8311ae0b3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_CLOUD_SERVICES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\nwhere CREDITS_USED_CLOUD_SERVICES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.182451Z", "completed_at": "2025-11-19T17:27:21.188329Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.190549Z", "completed_at": "2025-11-19T17:27:21.190556Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016374588012695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_cortex_usage_daily_history_CREDITS_USED_COMPUTE.a9a1ffe4d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_COMPUTE\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_cortex_usage_daily_history\nwhere CREDITS_USED_COMPUTE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.194132Z", "completed_at": "2025-11-19T17:27:21.199632Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.201632Z", "completed_at": "2025-11-19T17:27:21.201640Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014485597610473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_automatic_clustering_history_CREDITS_USED.a725f2a3a4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_automatic_clustering_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.191276Z", "completed_at": "2025-11-19T17:27:21.200129Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.202353Z", "completed_at": "2025-11-19T17:27:21.202360Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015876293182373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_automatic_clustering_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_automatic_clustering_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by all\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_automatic_clustering_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.203605Z", "completed_at": "2025-11-19T17:27:21.213260Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.215358Z", "completed_at": "2025-11-19T17:27:21.215365Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01644754409790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_automatic_clustering_history_NUM_BYTES_RECLUSTERED.50d6f53e7c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect NUM_BYTES_RECLUSTERED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_automatic_clustering_history\nwhere NUM_BYTES_RECLUSTERED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.208295Z", "completed_at": "2025-11-19T17:27:21.214875Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.223939Z", "completed_at": "2025-11-19T17:27:21.223947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0233919620513916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_automatic_clustering_history_NUM_ROWS_RECLUSTERED.9cbdf10dc6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect NUM_ROWS_RECLUSTERED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_automatic_clustering_history\nwhere NUM_ROWS_RECLUSTERED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.216125Z", "completed_at": "2025-11-19T17:27:21.226730Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.228723Z", "completed_at": "2025-11-19T17:27:21.228730Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016613483428955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_database_storage_usage_history_AVERAGE_DATABASE_BYTES.39c5c9dc44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect AVERAGE_DATABASE_BYTES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_database_storage_usage_history\nwhere AVERAGE_DATABASE_BYTES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.219755Z", "completed_at": "2025-11-19T17:27:21.227721Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.229936Z", "completed_at": "2025-11-19T17:27:21.229943Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017246723175048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_database_storage_usage_history_AVERAGE_FAILSAFE_BYTES.9c9e705d16", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect AVERAGE_FAILSAFE_BYTES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_database_storage_usage_history\nwhere AVERAGE_FAILSAFE_BYTES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.230691Z", "completed_at": "2025-11-19T17:27:21.241343Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.245450Z", "completed_at": "2025-11-19T17:27:21.245459Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019332170486450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_database_storage_usage_history_AVERAGE_HYBRID_TABLE_STORAGE_BYTES.81b58c1e43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect AVERAGE_HYBRID_TABLE_STORAGE_BYTES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_database_storage_usage_history\nwhere AVERAGE_HYBRID_TABLE_STORAGE_BYTES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.234984Z", "completed_at": "2025-11-19T17:27:21.242331Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.249236Z", "completed_at": "2025-11-19T17:27:21.249244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0221099853515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_data_transfer_history_BYTES_TRANSFERRED.5c6dcbbaf5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect BYTES_TRANSFERRED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_data_transfer_history\nwhere BYTES_TRANSFERRED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.242825Z", "completed_at": "2025-11-19T17:27:21.252534Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.254453Z", "completed_at": "2025-11-19T17:27:21.254461Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014941215515136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_state_entities__active", "compiled": true, "compiled_code": "\n\nwith\nactive_entities as (\n    select *\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_department_of_finance__entities\n    where\n        do_not_use = false\n        and abolished = false\n        and restricted_use is null\n        and cast(primary_code as int) < 9000\n        and not regexp_like(lower(name_raw), 'moved to|renum\\.? to')\n)\n\nselect *\nfrom active_entities", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__active", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.246217Z", "completed_at": "2025-11-19T17:27:21.253001Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.255180Z", "completed_at": "2025-11-19T17:27:21.255187Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014992475509643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_state_entities__technical", "compiled": true, "compiled_code": "\n\nwith\ntechnical_entities as (\n    select *\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_department_of_finance__entities\n    where\n        (do_not_use = false and abolished = false)\n        and (restricted_use is not null or cast(primary_code as int) >= 9000)\n)\n\nselect *\nfrom technical_entities", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__technical", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.255928Z", "completed_at": "2025-11-19T17:27:21.265453Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.267446Z", "completed_at": "2025-11-19T17:27:21.267453Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01605534553527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_department_of_finance__entities_primary_code.ab13df4014", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect primary_code\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_department_of_finance__entities\nwhere primary_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.259332Z", "completed_at": "2025-11-19T17:27:21.266942Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.270974Z", "completed_at": "2025-11-19T17:27:21.270983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01902914047241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_ebudget__budgets_primary_code.11fe170121", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect primary_code\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_ebudget__budgets\nwhere primary_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.268672Z", "completed_at": "2025-11-19T17:27:21.277122Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.279243Z", "completed_at": "2025-11-19T17:27:21.279251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014476537704467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_materialized_view_refresh_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_materialized_view_refresh_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by all\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_materialized_view_refresh_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.272391Z", "completed_at": "2025-11-19T17:27:21.278768Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.283171Z", "completed_at": "2025-11-19T17:27:21.283180Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017332077026367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_materialized_view_refresh_history_CREDITS_USED.99ec1064cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_materialized_view_refresh_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.280506Z", "completed_at": "2025-11-19T17:27:21.290044Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.292024Z", "completed_at": "2025-11-19T17:27:21.292032Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015505552291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_pipe_usage_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_pipe_usage_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by all\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_pipe_usage_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.284589Z", "completed_at": "2025-11-19T17:27:21.291548Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.300498Z", "completed_at": "2025-11-19T17:27:21.300510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022897720336914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_metering_daily_history_CREDITS_ADJUSTMENT_CLOUD_SERVICES.c3a1b97e7c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_ADJUSTMENT_CLOUD_SERVICES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history\nwhere CREDITS_ADJUSTMENT_CLOUD_SERVICES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.296835Z", "completed_at": "2025-11-19T17:27:21.303453Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.305388Z", "completed_at": "2025-11-19T17:27:21.305396Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015926361083984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_metering_daily_history_CREDITS_USED.e0bda296a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.292798Z", "completed_at": "2025-11-19T17:27:21.304433Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.306657Z", "completed_at": "2025-11-19T17:27:21.306664Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017833232879638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_metering_daily_history_CREDITS_BILLED.c40a5ea2de", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_BILLED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history\nwhere CREDITS_BILLED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.307395Z", "completed_at": "2025-11-19T17:27:21.319858Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.321815Z", "completed_at": "2025-11-19T17:27:21.321824Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018984079360961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_metering_daily_history_CREDITS_USED_CLOUD_SERVICES.5e7b5bc5ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_CLOUD_SERVICES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history\nwhere CREDITS_USED_CLOUD_SERVICES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.314664Z", "completed_at": "2025-11-19T17:27:21.320322Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.322597Z", "completed_at": "2025-11-19T17:27:21.322604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01874089241027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_metering_daily_history_CREDITS_USED_COMPUTE.de66f49909", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_COMPUTE\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_metering_daily_history\nwhere CREDITS_USED_COMPUTE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.323818Z", "completed_at": "2025-11-19T17:27:21.334643Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.340085Z", "completed_at": "2025-11-19T17:27:21.340104Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02120065689086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_pipe_usage_history_BYTES_INSERTED.1a924fd3d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect BYTES_INSERTED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_pipe_usage_history\nwhere BYTES_INSERTED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.329125Z", "completed_at": "2025-11-19T17:27:21.339583Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.344583Z", "completed_at": "2025-11-19T17:27:21.344595Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023863792419433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_pipe_usage_history_CREDITS_USED.307c286f38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_pipe_usage_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.335688Z", "completed_at": "2025-11-19T17:27:21.345976Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.348202Z", "completed_at": "2025-11-19T17:27:21.348209Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01544499397277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_pipe_usage_history_FILES_INSERTED.848ae546a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect FILES_INSERTED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_pipe_usage_history\nwhere FILES_INSERTED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.341053Z", "completed_at": "2025-11-19T17:27:21.347702Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.349944Z", "completed_at": "2025-11-19T17:27:21.349954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016649723052978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_stage_storage_usage_history_AVERAGE_STAGE_BYTES.e149896f90", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect AVERAGE_STAGE_BYTES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_stage_storage_usage_history\nwhere AVERAGE_STAGE_BYTES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.351757Z", "completed_at": "2025-11-19T17:27:21.360496Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.365643Z", "completed_at": "2025-11-19T17:27:21.365653Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018551111221313477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_storage_daily_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_storage_daily_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by all\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_storage_daily_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.355425Z", "completed_at": "2025-11-19T17:27:21.364995Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.369180Z", "completed_at": "2025-11-19T17:27:21.369192Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020333290100097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_storage_daily_history_AVERAGE_BYTES.5ea21eea9f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect AVERAGE_BYTES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_storage_daily_history\nwhere AVERAGE_BYTES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.361625Z", "completed_at": "2025-11-19T17:27:21.370121Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.372375Z", "completed_at": "2025-11-19T17:27:21.372382Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01764702796936035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_storage_daily_history_CREDITS_USED.d25246cda1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_storage_daily_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.366462Z", "completed_at": "2025-11-19T17:27:21.371822Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.374135Z", "completed_at": "2025-11-19T17:27:21.374142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014841079711914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_warehouse_metering_history", "compiled": true, "compiled_code": "with source as (\n    select * from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_warehouse_metering_history\n),\n\nusage_history as (\n    select\n        organization_name,\n        account_name,\n        usage_date,\n        sum(credits_used) as credits_used\n    from source\n    group by all\n)\n\nselect * from usage_history", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_warehouse_metering_history", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.377564Z", "completed_at": "2025-11-19T17:27:21.387400Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.394503Z", "completed_at": "2025-11-19T17:27:21.394512Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021453142166137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_warehouse_metering_history_CREDITS_USED.6be5e83057", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_warehouse_metering_history\nwhere CREDITS_USED is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.381293Z", "completed_at": "2025-11-19T17:27:21.391360Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.395361Z", "completed_at": "2025-11-19T17:27:21.395370Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0218203067779541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_warehouse_metering_history_CREDITS_USED_CLOUD_SERVICES.73169b4790", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_CLOUD_SERVICES\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_warehouse_metering_history\nwhere CREDITS_USED_CLOUD_SERVICES is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.387940Z", "completed_at": "2025-11-19T17:27:21.396215Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.398395Z", "completed_at": "2025-11-19T17:27:21.398402Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.021456480026245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_stg_warehouse_metering_history_CREDITS_USED_COMPUTE.28893f37fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect CREDITS_USED_COMPUTE\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.stg_warehouse_metering_history\nwhere CREDITS_USED_COMPUTE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.391891Z", "completed_at": "2025-11-19T17:27:21.397932Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.400732Z", "completed_at": "2025-11-19T17:27:21.400739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015240907669067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.dim_state_entities__agencies", "compiled": true, "compiled_code": "\n\nwith\nagencies as (\n    select\n        name,\n        agency_code\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__active\n    where subagency_code is null and l1 is null\n)\n\nselect *\nfrom agencies", "relation_name": "ANALYTICS_DEV.ci_should_not_create_this_schema_state_entities.dim_state_entities__agencies", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.404277Z", "completed_at": "2025-11-19T17:27:21.416531Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.421328Z", "completed_at": "2025-11-19T17:27:21.421341Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0222933292388916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.int_state_entities__budgets", "compiled": true, "compiled_code": "\n\nwith\nactive_entities as (select * from TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__active),\n\nbudgets as (select * from TRANSFORM_DEV.ci_should_not_create_this_schema_department_of_finance.stg_ebudget__budgets),\n\nactive_agencies_and_departments as (\n    -- only select at deparment level or higher\n    select * from active_entities\n    where coalesce(l2, l3) is null\n),\n\nactive_entity_budgets as (\n    select\n        active_agencies_and_departments.primary_code,\n        active_agencies_and_departments.ucm_level,\n        active_agencies_and_departments.name,\n        active_agencies_and_departments.name_alpha,\n        budgets.name as budget_name,\n        budgets.budget_year_dollars\n    from active_agencies_and_departments\n    left join\n        budgets\n        on active_agencies_and_departments.primary_code = budgets.primary_code\n)\n\nselect *\nfrom active_entity_budgets\norder by primary_code asc", "relation_name": "TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__budgets", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.407321Z", "completed_at": "2025-11-19T17:27:21.420664Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.422713Z", "completed_at": "2025-11-19T17:27:21.422720Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02259993553161621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_int_state_entities__active_primary_code.498a9cc863", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect primary_code\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__active\nwhere primary_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.412753Z", "completed_at": "2025-11-19T17:27:21.422125Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.424662Z", "completed_at": "2025-11-19T17:27:21.424669Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02109384536743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.unique_int_state_entities__active_primary_code.cb6e0784fe", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    primary_code as unique_field,\n    count(*) as n_records\n\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__active\nwhere primary_code is not null\ngroup by primary_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.417160Z", "completed_at": "2025-11-19T17:27:21.424062Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.426458Z", "completed_at": "2025-11-19T17:27:21.426465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01562809944152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_int_state_entities__technical_primary_code.92bdfb0772", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect primary_code\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__technical\nwhere primary_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.430201Z", "completed_at": "2025-11-19T17:27:21.443509Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.447581Z", "completed_at": "2025-11-19T17:27:21.447591Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021729469299316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dse_analytics.snowflake_costs_by_date", "compiled": true, "compiled_code": "/*\nTODO: this does not yet account for credits consumed by:\n\n  * Query acceleration\n  * Search optimization\n  * Replication/failover groups\n*/\n\nwith automatic_clustering_history as (\n    select\n        account_name,\n        usage_date,\n        'automatic clustering' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_automatic_clustering_history\n),\n\nmaterialized_view_refresh_history as (\n    select\n        account_name,\n        usage_date,\n        'materialized view' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_materialized_view_refresh_history\n),\n\npipe_usage_history as (\n    select\n        account_name,\n        usage_date,\n        'pipe' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_pipe_usage_history\n),\n\nstorage_daily_history as (\n    select\n        account_name,\n        usage_date,\n        'storage' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_storage_daily_history\n),\n\nwarehouse_metering_history as (\n    select\n        account_name,\n        usage_date,\n        'warehouse' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_warehouse_metering_history\n),\n\ncortex_usage_daily_history as (\n    select\n        account_name,\n        usage_date,\n        'cortex' as usage_type,\n        credits_used\n    from TRANSFORM_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.int_cortex_usage_daily_history\n),\n\n-- Combine the data in long form to allow for easy\n-- aggregations and visualizations.\ncombined as (\n    select * from automatic_clustering_history\n    union all\n    select * from materialized_view_refresh_history\n    union all\n    select * from pipe_usage_history\n    union all\n    select * from storage_daily_history\n    union all\n    select * from warehouse_metering_history\n    union all\n    select * from cortex_usage_daily_history\n)\n\nselect * from combined", "relation_name": "ANALYTICS_DEV.ci_should_not_create_this_schema_snowflake_cost_tracking.snowflake_costs_by_date", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.435377Z", "completed_at": "2025-11-19T17:27:21.448377Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.450043Z", "completed_at": "2025-11-19T17:27:21.450051Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022384166717529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_dim_state_entities__agencies_agency_code.8ad3a79d8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect agency_code\nfrom ANALYTICS_DEV.ci_should_not_create_this_schema_state_entities.dim_state_entities__agencies\nwhere agency_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.439485Z", "completed_at": "2025-11-19T17:27:21.449537Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.451875Z", "completed_at": "2025-11-19T17:27:21.451882Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.022745847702026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_dim_state_entities__agencies_name.d3e367a95b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom ANALYTICS_DEV.ci_should_not_create_this_schema_state_entities.dim_state_entities__agencies\nwhere name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.444060Z", "completed_at": "2025-11-19T17:27:21.451389Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.453671Z", "completed_at": "2025-11-19T17:27:21.453678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019447803497314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.unique_dim_state_entities__agencies_agency_code.efd290c291", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    agency_code as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS_DEV.ci_should_not_create_this_schema_state_entities.dim_state_entities__agencies\nwhere agency_code is not null\ngroup by agency_code\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.459144Z", "completed_at": "2025-11-19T17:27:21.463103Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.463629Z", "completed_at": "2025-11-19T17:27:21.463638Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009200096130371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.not_null_int_state_entities__budgets_primary_code.2d2e132a3f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect primary_code\nfrom TRANSFORM_DEV.ci_should_not_create_this_schema_state_entities.int_state_entities__budgets\nwhere primary_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T17:27:21.455025Z", "completed_at": "2025-11-19T17:27:21.464337Z"}, {"name": "execute", "started_at": "2025-11-19T17:27:21.464920Z", "completed_at": "2025-11-19T17:27:21.464927Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014152050018310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dse_analytics.unique_dim_state_entities__agencies_name.44718adf21", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    name as unique_field,\n    count(*) as n_records\n\nfrom ANALYTICS_DEV.ci_should_not_create_this_schema_state_entities.dim_state_entities__agencies\nwhere name is not null\ngroup by name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 5.3764448165893555, "args": {"select": [], "skip_nodes_if_on_run_start_fails": true, "log_format": "default", "partial_parse": true, "cache_selected_only": false, "require_resource_names_without_spaces": true, "write_json": true, "partial_parse_file_diff": true, "use_fast_test_edges": false, "profiles_dir": "ci", "log_level_file": "debug", "printer_width": 80, "log_format_file": "debug", "defer": false, "use_colors": true, "quiet": false, "indirect_selection": "eager", "log_path": "transform/logs", "favor_state": false, "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": true, "compile": true, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "vars": {}, "log_level": "info", "static_parser": true, "populate_cache": true, "invocation_command": "dbt docs generate --project-dir=transform", "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "static": false, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "print": true, "require_all_warnings_handled_by_warn_error": false, "which": "generate", "use_colors_file": true, "project_dir": "transform", "macro_debugging": false, "strict_mode": false, "log_file_max_bytes": 10485760, "introspect": true, "state_modified_compare_vars": false, "upload_to_artifacts_ingest_api": false, "send_anonymous_usage_stats": false, "require_nested_cumulative_type_params": false, "empty_catalog": false, "show_all_deprecations": false}}